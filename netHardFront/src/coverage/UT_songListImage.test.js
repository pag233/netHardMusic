import React from 'react';
import { screen } from '@testing-library/react';
import '@testing-library/jest-dom/extend-expect';

import { SongListImage } from '../components/common/songlist';

import { renderWithStateAndRouter } from './helper';

const list = [{ "private": true, "description": null, "deleteable": false, "played": 212, "tags": [], "faver": [], "shared": 0, "tracks": [{ "_id": "5fcc92b66fbf583170319a3d", "name": "Ballade Pour Adeline (Seneville Toussaint)", "artist": "James Last", "album": "Classics Up To Date Vol. 5", "coverUrl": "/images/covers/855420046460208.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a44", "name": "Waltz In A Flat Major Op. 39 No. 15", "artist": "James Last", "album": "Classics Up To Date Vol.1", "coverUrl": "/images/covers/1792203953274927.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a32", "name": "Sonata No.8 In C Minor Opus 13 \"Pathétique\": 2. Adagio", "artist": "James Last And His Orchestra", "album": "Eighty Not Out", "coverUrl": "/images/covers/649811372025082.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }], "_id": "5fcaf3eb3c8c5708287edbf6", "name": "我喜欢的音乐", "icon": "fav", "createdAt": "2020-12-05T02:43:55.183Z", "updatedAt": "2021-03-02T09:27:50.146Z", "commentThread": "601222e2f1c7f132d4dbc687" }, { "private": false, "description": "简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试简介测试", "deleteable": true, "played": 223, "tags": ["华语", "粤语", "小语种"], "faver": [], "shared": 0, "tracks": [{ "_id": "5fcc92b66fbf583170319a2b", "name": "The Last Waltz", "artist": "James Last", "album": "The Very Best Of", "coverUrl": "/images/covers/109951164004549407.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.902Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a30", "name": "J. Strauss II: Rosen Aus Dem Süden Opus 388 (Edit)", "artist": "James Last And His Orchestra", "album": "Eighty Not Out", "coverUrl": "/images/covers/649811372025082.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a31", "name": "Symphony No.7 In A flat Opus 92: 3. Presto", "artist": "James Last And His Orchestra", "album": "Eighty Not Out", "coverUrl": "/images/covers/649811372025082.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a32", "name": "Sonata No.8 In C Minor Opus 13 \"Pathétique\": 2. Adagio", "artist": "James Last And His Orchestra", "album": "Eighty Not Out", "coverUrl": "/images/covers/649811372025082.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a35", "name": "On A Persian Market", "artist": "James Last", "album": "Classics Up To Date Vol.1", "coverUrl": "/images/covers/1792203953274927.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a3d", "name": "Ballade Pour Adeline (Seneville Toussaint)", "artist": "James Last", "album": "Classics Up To Date Vol. 5", "coverUrl": "/images/covers/855420046460208.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }], "_id": "5fee98707277083e5041912c", "name": "轻音乐", "createdAt": "2021-01-01T03:35:12.796Z", "updatedAt": "2021-03-04T09:25:10.612Z", "coverUrl": "/images/covers/1609472160552539ce2aaf4922e2c", "commentThread": "601222e2f1c7f132d4dbc688" }, { "private": false, "description": "", "deleteable": true, "played": 14, "tags": [], "faver": [], "shared": 0, "tracks": [{ "_id": "5fcc92b66fbf583170319a34", "name": "The Rose Of Tralee", "artist": "James Last And His Orchestra", "album": "The Rose Of Tralee", "coverUrl": "/images/covers/769658139452721.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a32", "name": "Sonata No.8 In C Minor Opus 13 \"Pathétique\": 2. Adagio", "artist": "James Last And His Orchestra", "album": "Eighty Not Out", "coverUrl": "/images/covers/649811372025082.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a3d", "name": "Ballade Pour Adeline (Seneville Toussaint)", "artist": "James Last", "album": "Classics Up To Date Vol. 5", "coverUrl": "/images/covers/855420046460208.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a44", "name": "Waltz In A Flat Major Op. 39 No. 15", "artist": "James Last", "album": "Classics Up To Date Vol.1", "coverUrl": "/images/covers/1792203953274927.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }], "_id": "5fee9b5a7277083e5041912e", "name": "古典", "createdAt": "2021-01-01T03:47:38.227Z", "updatedAt": "2021-01-28T02:35:14.577Z", "coverUrl": "/images/covers/160947287920931b16bd6d55d3e7b", "commentThread": "601222e2f1c7f132d4dbc689" }, { "private": false, "description": "", "deleteable": true, "played": 1, "tags": [], "faver": [], "shared": 0, "tracks": [{ "_id": "5fcc92b66fbf583170319a37", "name": "In The Mood", "artist": "Paul Mauriat", "album": "Nostaljazz", "coverUrl": "/images/covers/938982930166804.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a3d", "name": "Ballade Pour Adeline (Seneville Toussaint)", "artist": "James Last", "album": "Classics Up To Date Vol. 5", "coverUrl": "/images/covers/855420046460208.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }], "_id": "5feea0b27277083e50419131", "name": "民谣", "createdAt": "2021-01-01T04:10:26.858Z", "updatedAt": "2021-01-28T02:35:14.580Z", "coverUrl": "/images/covers/160947707208208549d116118851b", "commentThread": "601222e2f1c7f132d4dbc68a" }, { "private": false, "description": "", "deleteable": true, "played": 0, "tags": [], "faver": [], "shared": 0, "tracks": [{ "_id": "5fcc92b66fbf583170319a3d", "name": "Ballade Pour Adeline (Seneville Toussaint)", "artist": "James Last", "album": "Classics Up To Date Vol. 5", "coverUrl": "/images/covers/855420046460208.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }], "_id": "5feea0cd7277083e50419132", "name": "小语种", "createdAt": "2021-01-01T04:10:53.507Z", "updatedAt": "2021-01-28T02:35:14.582Z", "coverUrl": "/images/covers/1609477066640e07f671f6c779b7f", "commentThread": "601222e2f1c7f132d4dbc68b" }, { "private": false, "description": "", "deleteable": true, "played": 0, "tags": [], "faver": [], "shared": 0, "tracks": [{ "_id": "5fcc92b66fbf583170319a34", "name": "The Rose Of Tralee", "artist": "James Last And His Orchestra", "album": "The Rose Of Tralee", "coverUrl": "/images/covers/769658139452721.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a32", "name": "Sonata No.8 In C Minor Opus 13 \"Pathétique\": 2. Adagio", "artist": "James Last And His Orchestra", "album": "Eighty Not Out", "coverUrl": "/images/covers/649811372025082.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.903Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a3d", "name": "Ballade Pour Adeline (Seneville Toussaint)", "artist": "James Last", "album": "Classics Up To Date Vol. 5", "coverUrl": "/images/covers/855420046460208.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }, { "_id": "5fcc92b66fbf583170319a44", "name": "Waltz In A Flat Major Op. 39 No. 15", "artist": "James Last", "album": "Classics Up To Date Vol.1", "coverUrl": "/images/covers/1792203953274927.jpg", "url": "audios/DrYPf0kbFyRN3VzAp96gSA==1607235376835.mp3", "size": 5841016, "createdAt": "2020-12-06T08:13:42.904Z", "updatedAt": "2020-12-06T13:50:34.731Z", "__v": 0, "duration": 146 }], "_id": "5feea1017277083e50419135", "name": "蓝调", "createdAt": "2021-01-01T04:11:45.064Z", "updatedAt": "2021-01-28T02:35:14.578Z", "coverUrl": "/images/covers/1609477053950ad6f2788d612070f", "commentThread": "601222e2f1c7f132d4dbc68c" }, { "private": false, "description": "", "deleteable": true, "played": 0, "tags": [], "faver": [], "shared": 0, "tracks": [], "_id": "601183a368997f03f0cbec3a", "name": "独立", "commentThread": "601222e2f1c7f132d4dbc692", "createdAt": "2021-01-27T15:15:47.149Z", "updatedAt": "2021-01-28T02:35:14.592Z" }];

const maxCountList = [1, 3, 5, 10, 100];

it.each(maxCountList)('should display item count less than assigned maxCount value', async (maxCount) => {
  renderWithStateAndRouter(
    <SongListImage list={list} maxCount={maxCount} />
  );
  const items = await screen.findAllByTestId('songlist-image');
  expect(items.length).toBeLessThanOrEqual(maxCount);
});

const params = [{ maxCount: 0 }, { xRatio: 0 }, { yRatio: 0 }, {
  maxCount: -1,
  xRatio: -1,
  yRatio: -1
}];

it.each(params)('when passing none postive params should throw range error.', (param) => {
  expect(() => {
    renderWithStateAndRouter(
      <SongListImage list={list} maxCount={param?.maxCount} xRatio={param?.xRatio} yRatio={param?.yRatio} />
    );
  }).toThrowError();
});